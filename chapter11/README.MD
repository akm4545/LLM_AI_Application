# **자신의 데이터에 맞춘 임베딩 모델 만들기: RAG 개선하기**  
교차 인코더는 비교하려는 두 문장을 입력으로 받아 직접 비교학 떄문에 유사도를 더 정확히 계산할 수 있지만 느리고 확장성이 떨어졌다. 바이 인코더는 
입력 문장에 대해 독립적인 문장 임베딩을 생성하고 임베딩끼리 코사인 유사도 같은 가벼운 거리 계산 방식으로 유사도를 계산하기 때문에 큰 데이터셋에서도 
빠르게 가장 비슷한 문장을 찾을 수 있었다. 이런 장점을 통해 바이 인코더는 문장 임베딩을 생성하는 대표적인 방식으로 사용되며 검색 증강 생성(RAG)
의 필수 구성요소로 활용된다.  
  
이번 장에서는 먼저 느리지만 정확한 교차 인코더와 빠르지만 덜 정확한 바이 인코더를 결합해 RAG의 검색 성능을 높이는 방법을 알아본다.  
  
교차 인코더는 느리기 때문에 대규모 데이터의 유사도를 계산하는 데 사용하지 않고 바이 인코더를 통해 선별된 소수의 데이터를 대상으로 더 정확한 
유사도 계산을 위해 사용한다. 교차 인코더를 활용해 필터링된 문장 사이의 유사도를 계산하고 순위를 변경하는 것을 순위 재정렬(re-rank)이라고 한다. 
  
실습에 필요한 라이브러리 설치  

!pip install sentence-transformers==2.7.0 datasets==2.19.0 huggingface_hub==0.23.0 faiss-cpu==1.8.0 -qqq  
  
